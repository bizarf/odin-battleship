(()=>{"use strict";var e={d:(t,r)=>{for(var s in r)e.o(r,s)&&!e.o(t,s)&&Object.defineProperty(t,s,{enumerable:!0,get:r[s]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};e.d({},{U:()=>S,y:()=>b});const t=class{constructor(e){this.name=e,this.turn=!1,this.board=new class{constructor(){this.board=[],this.makeBoard(),this.ships=[],this.carrierPlaced=!1,this.battleshipPlaced=!1,this.cruiserPlaced=!1,this.submarinePlaced=!1,this.destroyerPlaced=!1}makeBoard(){for(let e=0;e<8;e++){this.board[e]=[];for(let t=0;t<8;t++)this.board[e][t]={ship:!1,hit:!1,missedShot:!1}}}resetBoard(){this.board=[],this.makeBoard(),this.ships=[],this.carrierPlaced=!1,this.battleshipPlaced=!1,this.cruiserPlaced=!1,this.submarinePlaced=!1,this.destroyerPlaced=!1}placeShip(e,t,r,s){if(!0===this.isPlaceable(e,s,t)){const a=new class{constructor(e,t){this.name=e,this.length=t,this.hits=0}hit(){return this.hits+=1}isSunk(){return this.length===this.hits}}(r,s);if(this.ships.push(a),"hor"===t)for(let t=0;t<s;t++)this.board[e[0]][e[1]+t].ship=r;if("vert"===t)for(let t=0;t<s;t++)this.board[e[0]+t][e[1]].ship=r}return!1}isPlaceable(e,t,r){const s=[];if("hor"===r){if(e[1]+t-1>7)return!1;for(let r=0;r<t;r++)!1===this.board[e[0]][e[1]+r].ship&&s.push(this.board[e[0]][e[1]+r].ship)}if("vert"===r){if(e[0]+t-1>7)return!1;for(let r=0;r<t;r++)!1===this.board[e[0]+r][e[1]].ship&&s.push(this.board[e[0]+r][e[1]].ship)}return s.length==t}receiveAttack(e){const t=this.board[e[0]][e[1]];if(!0===t.hit||!0===t.missedShot)return!1;if(0!=t.ship){const e=this.getShipIndex(t.ship);return this.ships[e].hit(),t.hit=!0,!0}return!1===t.ship?(t.missedShot=!0,!0):void 0}getShipIndex(e){return this.ships.map((e=>e.name)).indexOf(e)}checkAllShipStatus(){return this.ships.map((e=>e.isSunk())).every((e=>{if(!0===e)return!0}))}placeShipTeamRandomly(){const e=["hor","vert"],t=Math.floor(2*Math.random()),r=[Math.floor(8*Math.random()),Math.floor(8*Math.random())];!1===this.carrierPlaced&&this.placeShipPieceRandomly(r,5,e,t,"carrier"),!1===this.battleshipPlaced&&this.placeShipPieceRandomly(r,4,e,t,"battleship"),!1===this.cruiserPlaced&&this.placeShipPieceRandomly(r,3,e,t,"cruiser"),!1===this.submarinePlaced&&this.placeShipPieceRandomly(r,3,e,t,"submarine"),!1===this.destroyerPlaced&&this.placeShipPieceRandomly(r,2,e,t,"destroyer")}placeShipPieceRandomly(e,t,r,s,a){!1===this.isPlaceable(e,t,r[s])&&this.placeShipTeamRandomly(),!0===this.isPlaceable(e,t,r[s])&&(this.placeShip(e,r[s],a,t),this.shipPlacedTrue(a))}shipPlacedTrue(e){switch(e){case"carrier":this.carrierPlaced=!0;break;case"battleship":this.battleshipPlaced=!0;break;case"cruiser":this.cruiserPlaced=!0;break;case"submarine":this.submarinePlaced=!0;break;case"destroyer":this.destroyerPlaced=!0}}checkAllShipsPlaced(){return!1!==this.carrierPlaced&&!1!==this.battleshipPlaced&&!1!==this.cruiserPlaced&&!1!==this.submarinePlaced&&!1!==this.destroyerPlaced}}}computerPlay(){const e=[Math.floor(8*Math.random()),Math.floor(8*Math.random())];!0!==b.board.receiveAttack(e)?!1===b.board.receiveAttack(e)&&this.computerPlay():b.board.receiveAttack(e)}},r=document.querySelector(".playerBoard"),s=document.querySelector(".computerBoard"),a=document.querySelector("#carrierPiece"),i=document.querySelector("#battleshipPiece"),o=document.querySelector("#cruiserPiece"),c=document.querySelector("#submarinePiece"),l=document.querySelector("#destroyerPiece"),d=()=>{for(let e=0;e<8;e++)for(let t=0;t<8;t++){const s=document.createElement("div");s.classList="playerBoardSquare",s.dataset.pos=[e,t],r.appendChild(s)}},n=()=>{for(let e=0;e<8;e++)for(let t=0;t<8;t++){const r=document.createElement("div");r.classList="computerBoardSquare",r.dataset.pos=[e,t],s.appendChild(r)}};function h(){document.querySelectorAll(".playerBoardSquare").forEach((e=>{const t=parseInt(e.dataset.pos[0]),r=parseInt(e.dataset.pos[2]),s=b.board.board[t][r];0!=s.ship&&e.classList.add("ship"),!0===s.hit&&(e.classList.remove("ship"),e.classList.add("shipStrike")),!0===s.missedShot&&e.classList.add("missedShot")}))}function p(){document.querySelectorAll(".computerBoardSquare").forEach((e=>{const t=parseInt(e.dataset.pos[0]),r=parseInt(e.dataset.pos[2]),s=S.board.board[t][r];!0===s.hit&&e.classList.add("shipStrike"),!0===s.missedShot&&e.classList.add("missedShot")}))}const u=(()=>{const e=e=>{e.addEventListener("dragstart",(e=>{e.dataTransfer.setData("text",e.target.classList)}))};return{init:()=>{const t=document.querySelector("#carrierPiece"),r=document.querySelector("#battleshipPiece"),s=document.querySelector("#cruiserPiece"),a=document.querySelector("#submarinePiece"),i=document.querySelector("#destroyerPiece");e(t),e(r),e(s),e(a),e(i)}}})();function y(){const e=document.querySelectorAll(".playerBoardSquare");e.forEach((e=>e.addEventListener("dragover",(e=>{e.preventDefault()})))),e.forEach((e=>e.addEventListener("drop",(t=>{t.preventDefault();const r=t.dataTransfer.getData("text");console.log(r),console.log(e.dataset.pos);const s=parseInt(e.dataset.pos[0]),d=parseInt(e.dataset.pos[2]),n=[s,d];switch(!0){case"carrierHor"===r&&d<=3&&!1===b.board.carrierPlaced:b.board.placeShip(n,"hor","carrier",5),a.style.display="none",h(),m();break;case"battleshipHor"===r&&d<=4:b.board.placeShip(n,"hor","battleship",4),i.style.display="none",h(),m();break;case"cruiserHor"===r&&d<=5:b.board.placeShip(n,"hor","cruiser",3),o.style.display="none",h(),m();break;case"submarineHor"===r&&d<=5:b.board.placeShip(n,"hor","submarine",3),c.style.display="none",h(),m();break;case"destroyerHor"===r&&d<=6:b.board.placeShip(n,"hor","destroyer",2),l.style.display="none",h(),m()}}))))}function m(){const e=document.querySelector("#startBtn");!0===b.board.checkAllShipsPlaced()&&(console.log("test"),e.disabled=!1)}const b=new t("human"),S=new t("computer");d(),n();const P=document.querySelector("#startBtn"),f=document.querySelector(".playerPieces"),q=document.querySelector(".computerBoard");P.addEventListener("click",(()=>{S.board.placeShipTeamRandomly(),f.style.display="none",q.style.display="grid",(()=>{const e=document.querySelectorAll(".computerBoardSquare"),t=document.querySelectorAll(".playerBoardSquare"),r=document.querySelector(".winnerText");e.forEach((s=>s.addEventListener("click",(()=>{const a=[parseInt(s.dataset.pos[0]),parseInt(s.dataset.pos[2])];return!1===S.board.checkAllShipStatus()&&(S.board.receiveAttack(a),p(),!0===S.board.checkAllShipStatus())?(e.forEach((e=>e.classList.add("disableBoards"))),t.forEach((e=>e.classList.add("disableBoards"))),p(),h(),r.textContent="Congratulations. You win!",void(v.style.display="block")):!1===b.board.checkAllShipStatus()&&(S.computerPlay(),h(),!0===b.board.checkAllShipStatus())?(e.forEach((e=>e.classList.add("disableBoards"))),t.forEach((e=>e.classList.add("disableBoards"))),h(),p(),r.textContent="The computer has sunk all your ships!",void(v.style.display="block")):void 0}))))})(),P.disabled=!0})),(()=>{const e=document.querySelector("#carrierPiece"),t=document.querySelector("#battleshipPiece"),r=document.querySelector("#cruiserPiece"),s=document.querySelector("#submarinePiece"),a=document.querySelector("#destroyerPiece");document.querySelector("#playerTeamRandomizeBtn").addEventListener("click",(()=>{b.board.placeShipTeamRandomly(),e.style.display="none",t.style.display="none",r.style.display="none",s.style.display="none",a.style.display="none",h(),m()}))})();const k=document.querySelector("#gameOverTest"),v=document.querySelector(".gameOverModal");k.addEventListener("click",(()=>{v.style.display="block"})),function(){const e=document.querySelector("#resetBtn"),t=document.querySelector(".gameOverModal"),h=document.querySelector(".playerPieces");e.addEventListener("click",(()=>{for(b.board.resetBoard(),S.board.resetBoard();r.firstChild;)r.removeChild(r.firstChild);for(;s.firstChild;)s.removeChild(s.firstChild);d(),n(),t.style.display="none",s.style.display="none",h.style.display="block",a.style.display="flex",i.style.display="flex",o.style.display="flex",c.style.display="flex",l.style.display="flex",u.init(),y()}))}(),u.init(),y()})();