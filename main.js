(()=>{"use strict";var e={d:(r,t)=>{for(var s in t)e.o(t,s)&&!e.o(r,s)&&Object.defineProperty(r,s,{enumerable:!0,get:t[s]})},o:(e,r)=>Object.prototype.hasOwnProperty.call(e,r)};e.d({},{UR:()=>P,Kx:()=>f,y1:()=>S});const r=class{constructor(e){this.name=e,this.turn=!1,this.board=new class{constructor(){this.board=[],this.makeBoard(),this.ships=[],this.carrierPlaced=!1,this.battleshipPlaced=!1,this.cruiserPlaced=!1,this.submarinePlaced=!1,this.destroyerPlaced=!1}makeBoard(){for(let e=0;e<8;e++){this.board[e]=[];for(let r=0;r<8;r++)this.board[e][r]={ship:!1,hit:!1,missedShot:!1}}}resetBoard(){this.board=[],this.makeBoard(),this.ships=[],this.carrierPlaced=!1,this.battleshipPlaced=!1,this.cruiserPlaced=!1,this.submarinePlaced=!1,this.destroyerPlaced=!1}placeShip(e,r,t,s){if(!0===this.isPlaceable(e,s,r)){const a=new class{constructor(e,r){this.name=e,this.length=r,this.hits=0}hit(){return this.hits+=1}isSunk(){return this.length===this.hits}}(t,s);if(this.ships.push(a),"hor"===r)for(let r=0;r<s;r++)this.board[e[0]][e[1]+r].ship=t;if("vert"===r)for(let r=0;r<s;r++)this.board[e[0]+r][e[1]].ship=t}return!1}isPlaceable(e,r,t){const s=[];if("hor"===t){if(e[1]+r-1>7)return!1;for(let t=0;t<r;t++)!1===this.board[e[0]][e[1]+t].ship&&s.push(this.board[e[0]][e[1]+t].ship)}if("vert"===t){if(e[0]+r-1>7)return!1;for(let t=0;t<r;t++)!1===this.board[e[0]+t][e[1]].ship&&s.push(this.board[e[0]+t][e[1]].ship)}return s.length==r}receiveAttack(e){const r=this.board[e[0]][e[1]];if(!0===r.hit||!0===r.missedShot)return!1;if(0!=r.ship){const e=this.getShipIndex(r.ship);return this.ships[e].hit(),r.hit=!0,!0}return!1===r.ship?(r.missedShot=!0,!0):void 0}getShipIndex(e){return this.ships.map((e=>e.name)).indexOf(e)}checkAllShipStatus(){return this.ships.map((e=>e.isSunk())).every((e=>{if(!0===e)return!0}))}placeShipTeamRandomly(){const e=["hor","vert"],r=Math.floor(2*Math.random()),t=[Math.floor(8*Math.random()),Math.floor(8*Math.random())];!1===this.carrierPlaced&&this.placeShipPieceRandomly(t,5,e,r,"carrier"),!1===this.battleshipPlaced&&this.placeShipPieceRandomly(t,4,e,r,"battleship"),!1===this.cruiserPlaced&&this.placeShipPieceRandomly(t,3,e,r,"cruiser"),!1===this.submarinePlaced&&this.placeShipPieceRandomly(t,3,e,r,"submarine"),!1===this.destroyerPlaced&&this.placeShipPieceRandomly(t,2,e,r,"destroyer")}placeShipPieceRandomly(e,r,t,s,a){!1===this.isPlaceable(e,r,t[s])&&this.placeShipTeamRandomly(),!0===this.isPlaceable(e,r,t[s])&&(this.placeShip(e,t[s],a,r),this.shipPlacedTrue(a))}shipPlacedTrue(e){switch(e){case"carrier":this.carrierPlaced=!0;break;case"battleship":this.battleshipPlaced=!0;break;case"cruiser":this.cruiserPlaced=!0;break;case"submarine":this.submarinePlaced=!0;break;case"destroyer":this.destroyerPlaced=!0}}checkAllShipsPlaced(){return!1!==this.carrierPlaced&&!1!==this.battleshipPlaced&&!1!==this.cruiserPlaced&&!1!==this.submarinePlaced&&!1!==this.destroyerPlaced}}}computerPlay(){const e=[Math.floor(8*Math.random()),Math.floor(8*Math.random())];!0!==S.board.receiveAttack(e)?!1===S.board.receiveAttack(e)&&this.computerPlay():S.board.receiveAttack(e)}},t=document.querySelector(".playerBoard"),s=document.querySelector(".computerBoard"),a=document.querySelector("#playerPieces"),i=document.querySelector("#carrierPiece"),c=document.querySelector("#battleshipPiece"),o=document.querySelector("#cruiserPiece"),l=document.querySelector("#submarinePiece"),d=document.querySelector("#destroyerPiece"),n=()=>{for(let e=0;e<8;e++)for(let r=0;r<8;r++){const s=document.createElement("div");s.classList="playerBoardSquare",s.dataset.pos=[e,r],t.appendChild(s)}},h=()=>{for(let e=0;e<8;e++)for(let r=0;r<8;r++){const t=document.createElement("div");t.classList="computerBoardSquare",t.dataset.pos=[e,r],s.appendChild(t)}},p=()=>{document.querySelectorAll(".playerBoardSquare").forEach((e=>{const r=parseInt(e.dataset.pos[0]),t=parseInt(e.dataset.pos[2]),s=S.board.board[r][t];0!=s.ship&&e.classList.add("ship"),!0===s.hit&&(e.classList.remove("ship"),e.classList.add("shipStrike")),!0===s.missedShot&&e.classList.add("missedShot")}))},u=()=>{document.querySelectorAll(".computerBoardSquare").forEach((e=>{const r=parseInt(e.dataset.pos[0]),t=parseInt(e.dataset.pos[2]),s=P.board.board[r][t];!0===s.hit&&e.classList.add("shipStrike"),!0===s.missedShot&&e.classList.add("missedShot")}))},y=(()=>{const e=e=>{e.addEventListener("dragstart",(e=>{e.dataTransfer.setData("text",e.target.classList)}))};return{init:()=>{const r=document.querySelector("#carrierPiece"),t=document.querySelector("#battleshipPiece"),s=document.querySelector("#cruiserPiece"),a=document.querySelector("#submarinePiece"),i=document.querySelector("#destroyerPiece");e(r),e(t),e(s),e(a),e(i)}}})(),b=()=>{const e=document.querySelectorAll(".playerBoardSquare");e.forEach((e=>e.addEventListener("dragover",(e=>{e.preventDefault()})))),e.forEach((e=>e.addEventListener("drop",(r=>{r.preventDefault();const t=r.dataTransfer.getData("text"),s=parseInt(e.dataset.pos[0]),a=parseInt(e.dataset.pos[2]),n=[s,a];switch(!0){case"carrierHor"===t&&a<=3&&!1===S.board.carrierPlaced:S.board.placeShip(n,"hor","carrier",5),S.board.carrierPlaced=!0,i.style.display="none",p(),m();break;case"battleshipHor"===t&&a<=4:S.board.placeShip(n,"hor","battleship",4),S.board.battleshipPlaced=!0,c.style.display="none",p(),m();break;case"cruiserHor"===t&&a<=5:S.board.placeShip(n,"hor","cruiser",3),S.board.cruiserPlaced=!0,o.style.display="none",p(),m();break;case"submarineHor"===t&&a<=5:S.board.placeShip(n,"hor","submarine",3),S.board.submarinePlaced=!0,l.style.display="none",p(),m();break;case"destroyerHor"===t&&a<=6:S.board.placeShip(n,"hor","destroyer",2),S.board.destroyerPlaced=!0,d.style.display="none",p(),m();break;case"carrierVert"===t&&s<=3&&!1===S.board.carrierPlaced:S.board.placeShip(n,"vert","carrier",5),S.board.carrierPlaced=!0,i.style.display="none",p(),m();break;case"battleshipVert"===t&&s<=4:S.board.placeShip(n,"vert","battleship",4),S.board.battleshipPlaced=!0,c.style.display="none",p(),m();break;case"cruiserVert"===t&&s<=5:S.board.placeShip(n,"vert","cruiser",3),S.board.cruiserPlaced=!0,o.style.display="none",p(),m();break;case"submarineVert"===t&&s<=5:S.board.placeShip(n,"vert","submarine",3),S.board.submarinePlaced=!0,l.style.display="none",p(),m();break;case"destroyerVert"===t&&s<=6:S.board.placeShip(n,"vert","destroyer",2),S.board.destroyerPlaced=!0,d.style.display="none",p(),m()}}))))},m=()=>{const e=document.querySelector("#startBtn");!0===S.board.checkAllShipsPlaced()&&(e.disabled=!1)},S=new r("human"),P=new r("computer");n(),h();const f=()=>{const e=document.querySelectorAll(".computerBoardSquare"),r=document.querySelectorAll(".playerBoardSquare"),t=document.querySelector(".winnerText"),s=document.querySelector(".gameOverModal");e.forEach((a=>a.addEventListener("click",(()=>{const i=[parseInt(a.dataset.pos[0]),parseInt(a.dataset.pos[2])];return!1===P.board.checkAllShipStatus()&&(P.board.receiveAttack(i),u(),!0===P.board.checkAllShipStatus())?(e.forEach((e=>e.classList.add("disableBoards"))),r.forEach((e=>e.classList.add("disableBoards"))),u(),p(),t.textContent="Congratulations. You win!",void(s.style.display="block")):!1===S.board.checkAllShipStatus()&&(P.computerPlay(),p(),!0===S.board.checkAllShipStatus())?(e.forEach((e=>e.classList.add("disableBoards"))),r.forEach((e=>e.classList.add("disableBoards"))),p(),u(),t.textContent="The computer has sunk all your ships!",void(s.style.display="block")):void 0}))))};(()=>{const e=document.querySelector("#carrierPiece"),r=document.querySelector("#battleshipPiece"),t=document.querySelector("#cruiserPiece"),s=document.querySelector("#submarinePiece"),a=document.querySelector("#destroyerPiece");document.querySelector("#playerTeamRandomizeBtn").addEventListener("click",(()=>{S.board.placeShipTeamRandomly(),e.style.display="none",r.style.display="none",t.style.display="none",s.style.display="none",a.style.display="none",p(),m()}))})(),(()=>{const e=document.querySelector("#resetBtn"),r=document.querySelector(".gameOverModal");e.addEventListener("click",(()=>{for(S.board.resetBoard(),P.board.resetBoard();t.firstChild;)t.removeChild(t.firstChild);for(;s.firstChild;)s.removeChild(s.firstChild);n(),h(),r.style.display="none",s.style.display="none",a.style.display="",a.classList="playerPiecesHor",i.classList="carrierHor",c.classList="battleshipHor",o.classList="cruiserHor",l.classList="submarineHor",d.classList="destroyerHor",i.style.display="",c.style.display="",o.style.display="",l.style.display="",d.style.display="",y.init(),b()}))})(),y.init(),b(),document.querySelector("#rotatePiecesBtn").addEventListener("click",(()=>{"playerPiecesHor"===a.className?(console.log("hor"),a.classList="playerPiecesVert",i.classList="carrierVert",c.classList="battleshipVert",o.classList="cruiserVert",l.classList="submarineVert",d.classList="destroyerVert"):"playerPiecesVert"===a.className&&(console.log("vert"),a.classList="playerPiecesHor",i.classList="carrierHor",c.classList="battleshipHor",o.classList="cruiserHor",l.classList="submarineHor",d.classList="destroyerHor")})),(()=>{const e=document.querySelector("#startBtn");e.addEventListener("click",(()=>{P.board.placeShipTeamRandomly(),a.style.display="none",s.style.display="grid",f(),e.disabled=!0}))})()})();